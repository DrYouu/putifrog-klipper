# putifrog.cfg — Leapfrog Creatr HS (Stock CreatrHS_Firmware_2.5) → Klipper
#
# Extracted from the provided Stock CreatrHS_Firmware_2.5 sources:
#  - Configuration.h (LEAPFROG_FIRMWARE_VERSION 2.5, model CreatrHS)
#  - Configuration_adv.h
#  - pins.h  (MOTHERBOARD==1, ATmega1280/2560)
#
# Notes:
# - This file mirrors the STOCK firmware defaults as closely as Klipper allows.
# - Set [mcu].serial to your actual /dev/serial/by-id/... path before use.

[mcu]
# Example:
# serial: /dev/serial/by-id/usb-1a86_USB2.0-Serial-if00-port0
serial: /dev/serial/by-id/REPLACE_ME
baud: 250000
restart_method: arduino

[printer]
kinematics: cartesian
max_velocity: 400
max_accel: 9000
max_z_velocity: 40
max_z_accel: 100
square_corner_velocity: 15.0

# -----------------
# AXES (pins from pins.h)
# Steps/mm from Configuration.h:
#   X,Y = (100/3)*2 = 66.6666667 steps/mm  → rotation_distance = 3200/66.6666667 = 48.0 mm/rev
#   Z   = 9600/10   = 960 steps/mm         → rotation_distance = 3200/960 = 3.333333333 mm/rev
# (Assumes 200-step motor and 16 microsteps.)
#
# Directions from Configuration.h:
#   INVERT_X_DIR false; INVERT_Y_DIR false; INVERT_Z_DIR true
# Enable polarity from Configuration.h:
#   X_ENABLE_ON 0; Y_ENABLE_ON 0; Z_ENABLE_ON 0 (active-low enable)
# Endstop inversion from Configuration.h:
#   X_ENDSTOPS_INVERTING=false; Y_ENDSTOPS_INVERTING=false; Z_ENDSTOPS_INVERTING=true
# Limits from Configuration.h:
#   X: 0..270, Y: 0..280, Z: 0..180
# Homing feedrate from Configuration.h: {70*60,70*60,20*60} mm/min → 70,70,20 mm/s
# Home retract from Configuration_adv.h: X 5, Y 5, Z 1

[stepper_x]
step_pin: ar28
dir_pin: ar63
enable_pin: !ar29
microsteps: 16
rotation_distance: 48.0
endstop_pin: ^ar47
position_endstop: 0
position_min: 0
position_max: 270
homing_speed: 70
homing_retract_dist: 5

[stepper_y]
step_pin: ar14
dir_pin: ar15
enable_pin: !ar39
microsteps: 16
rotation_distance: 48.0
endstop_pin: ^ar48
position_endstop: 0
position_min: 0
position_max: 280
homing_speed: 70
homing_retract_dist: 5

[stepper_z]
step_pin: ar31
dir_pin: !ar32
enable_pin: !ar30
microsteps: 16
rotation_distance: 3.333333333
endstop_pin: ^!ar49
position_endstop: 0
position_min: 0
position_max: 180
homing_speed: 20
homing_retract_dist: 1

# -----------------
# EXTRUDERS (EXTRUDERS=2, pins from pins.h)
# Steps/mm from Configuration.h:
#   E = 99.30 steps/mm → rotation_distance = 3200/99.30 = 32.235... mm/rev
# (Assumes 200-step motor and 16 microsteps.)
#
# Directions from Configuration.h:
#   INVERT_E0_DIR false; INVERT_E1_DIR true
# Enable polarity from Configuration.h:
#   E_ENABLE_ON 0 (active-low)
#
# Hotend offsets from Configuration.h:
#   EXTR2_X_OFFSET 15.00; EXTR2_Y_OFFSET 0.00
#   EXTRUDER_OFFSET_X {0.0, -15.0}; EXTRUDER_OFFSET_Y {0.0, -0.0}
# In the stock Marlin, selecting T1 shifts the coordinate system so that X commands are compensated by +15mm.
# The macros below implement the same behavior in Klipper via SET_GCODE_OFFSET.

[extruder]
step_pin: ar34
dir_pin: ar35
enable_pin: !ar33
microsteps: 16
rotation_distance: 32.235
nozzle_diameter: 0.4
filament_diameter: 1.75
heater_pin: ar9
sensor_type: EPCOS 100K B57560G104F
sensor_pin: analog13
min_temp: 5
max_temp: 300
min_extrude_temp: 150
max_extrude_only_distance: 550
control: pid
pid_Kp: 12.00
pid_Ki: 0.20
pid_Kd: 110.0

[extruder1]
step_pin: ar37
dir_pin: !ar40
enable_pin: !ar36
microsteps: 16
rotation_distance: 32.235
nozzle_diameter: 0.4
filament_diameter: 1.75
heater_pin: ar8
sensor_type: EPCOS 100K B57560G104F
sensor_pin: analog15
min_temp: 5
max_temp: 300
min_extrude_temp: 150
max_extrude_only_distance: 550
control: pid
pid_Kp: 12.00
pid_Ki: 0.20
pid_Kd: 110.0

# -----------------
# HEATED BED (pins from pins.h)
# TEMP_SENSOR_BED=1 in Configuration.h.
# USE_BED_PWM is NOT enabled in Configuration.h → stock firmware uses on/off control.
# In Klipper the closest equivalent is watermark control.

[heater_bed]
heater_pin: ar10
sensor_type: EPCOS 100K B57560G104F
sensor_pin: analog14
min_temp: 5
max_temp: 150
control: watermark
max_delta: 2.0

# -----------------
# PART COOLING FAN + LED (pins from pins.h)

[fan]
pin: ar5

[output_pin board_led]
pin: ar13
value: 0
shutdown_value: 0

# -----------------
# TOOLCHANGE MACROS (replicate stock Marlin offset behavior)

[gcode_macro T0]
gcode:
  ACTIVATE_EXTRUDER EXTRUDER=extruder
  SET_GCODE_OFFSET X=0.0 Y=0.0 MOVE=0

[gcode_macro T1]
gcode:
  ACTIVATE_EXTRUDER EXTRUDER=extruder1
  SET_GCODE_OFFSET X=15.0 Y=0.0 MOVE=0

# End of file
